# name: test/sql/setops/union_distinct_on.test
# description: Test UNION DISTINCT ON
# group: [setops]


statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE tbl1(a INTEGER, b INTEGER, c INTEGER);

statement ok
CREATE TABLE tbl2(a INTEGER, b INTEGER, c INTEGER);

statement ok
CREATE TABLE tbl3(a INTEGER, b INTEGER, c INTEGER);

statement ok
INSERT INTO tbl1 VALUES (1, 2, 3), (2, 4, 4);

statement ok
INSERT INTO tbl2 VALUES (1, 3, 2), (2, 3, 3);

statement ok
INSERT INTO tbl3 VALUES (1, 7, 6), (2, 5, 8);

query III
SELECT * FROM (VALUES (1,3,2), (1,2,3), (1,3,2)) AS _(a,b,c) UNION DISTINCT ON (a) SELECT * FROM (VALUES (1,1,2)) AS __(a,b,c) ORDER BY b;
----
1	1	2

query III
SELECT * FROM tbl1 UNION DISTINCT ON (a) SELECT * FROM tbl2 ORDER BY b;
----
1	2	3
2	3	3

query III
SELECT * FROM tbl1 UNION DISTINCT ON (b) SELECT * FROM tbl2 ORDER BY a, b;
----
1	2	3
1	3	2
2	4	4

query III
(SELECT * FROM tbl1 UNION DISTINCT ON (a) SELECT * FROM tbl2 ORDER BY b) UNION DISTINCT ON (c) SELECT * FROM tbl3 ORDER BY b;
----
1	2	3
2	5	8
1	7	6

query III
SELECT * FROM (VALUES (1, 2, 3), (1, 2, 4)) AS _(a,b,c) UNION DISTINCT ON (a,b) SELECT * FROM (VALUES (1,2,2), (1,3,4)) AS __(a,b,c) ORDER BY c;
----
1	2	2
1	3	4